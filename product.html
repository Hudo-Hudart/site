<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZooMarket - Магазин зоотоваров</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Внутри тега <header class="header"> заменяем существующую структуру на эту: -->
        <header class="header">
            <div class="header-main">
                <!-- Левый блок: Логотип -->
                <div class="logo-block">
                    <a href="/index.html">
                        <img src="/images/logo.png" alt="ЗооМаркет" class="logo">
                    </a>
                </div>
        
        
                <!-- Центральный блок: Поиск + Преимущества -->
                <div class="center-block">
                    <!-- Поисковая строка -->
                    <div class="search-container">
                        <input type="text" 
                               placeholder="Поиск по каталогу..." 
                               class="search-input">
                        <button class="search-button">Найти</button>
                    </div>
        
                    <!-- Блок преимуществ -->
                    <div class="advantages-container">
                        <div class="advantage">
                            <img src="/images/delivery.png" alt="Доставка">
                            <span>БЕСПЛАТНАЯ ДОСТАВКА<br>ДО ПОДЪЕЗДА ПО ГОРОДУ СОЧИ</span>
                        </div>
                        <div class="advantage">
                            <img src="/images/gift-icon.webp" alt="Бонусы">
                            <span>БОНУСЫ ДО 5% НА ВЕСЬ<br>АССОРТИМЕНТ</span>
                        </div>
                        <div class="advantage">
                            <img src="/images/consultant-icon.webp" alt="Консультанты">
                            <span>ПРОФЕССИОНАЛЬНЫЕ<br>КОНСУЛЬТАНТЫ</span>
                        </div>
                    </div>
                </div>
        
                <!-- Правый блок: Контакты + Иконки -->
                <div class="right-block">
                    <!-- Контактная информация -->
                    <div class="contacts">
                        <div class="phone">+7 (938) 441-39-13</div>
                        <div class="contact-links">
                            <a href="#" class="callback-link">Заказать звонок</a>
                            <div class="dropdown">
                                <span class="dots">•••</span>
                                <div class="dropdown-content">
                                    <div class="contact-info">
                                        <p>Сочи, ул. Яна Фабрициуса 58/5</p>
                                        <p>7 дней в неделю<br>с 08:00 до 19:00</p>
                                        <p>Email: <a href="mailto:info@zuf-zuf.ru">info@zuf-zuf.ru</a></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
        
                    <!-- Иконки действий -->
                    <div class="header-icons">
                        <!-- Избранное -->
                        <div class="icon-dropdown favorites">
                            <div class="icon-block">
                            <img src="/images/heart.png" alt="Избранное">
                             </div>
                            <span class="counter">0</span>
                            <div class="dropdown-content">
                                <div class="dropdown-header">
                                    <h4>Избранное</h4>
                                    <button class="clear-all">Очистить</button>
                                </div>
                                <div class="items-list"></div>
                                <div class="empty-message">
                                    <img src="/images/heart.png" alt="Избранное" class="empty-icon">
                                    <span>В вашем избранном пока пусто</span>
                                </div>
                            </div>
                        </div>
                    
                        <!-- Сравнение -->
                        <div class="icon-dropdown compare">
                            <div class="icon-block">
                                <img src="/images/compet.png" alt="Сравнение">
                            </div>
                            <div class="dropdown-content">
                                <div class="dropdown-header">
                                    <h4>Сравнение</h4>
                                    <button class="clear-all">Очистить</button>
                                </div>
                                <div class="items-list"></div>
                                <div class="empty-message">
                                    <img src="/images/compet.png" alt="Сравнение" class="empty-icon">
                                    <span>Товары для сравнения не выбраны</span>
                                </div>
                            </div>
                        </div>
                    
                        <!-- Корзина -->
                        <div class="icon-dropdown cart">
                            <div class="icon-block">
                            <img src="/images/cart.png" alt="Корзина">
                            </div>
                                <span class="counter">0</span>
                                <div class="dropdown-content">
                                    <div class="dropdown-header">
                                        <h4>Ваша корзина</h4>
                                        <button class="clear-all">Очистить</button>
                                    </div>

                                     <!-- Контейнер для списка товаров -->
                                    <div class="items-list"></div>
                                    
                                    <!-- Добавим иконку для пустой корзины -->
                                    <div class="empty-message">
                                        <img src="/images/cart.png" alt="Корзина" class="empty-icon">
                                        <span>В вашей корзине пока пусто</span>
                                    </div>
                                </div>
                        </div>
                    
                        <!-- Личный кабинет -->
                        <div class="icon-dropdown account">
                            <div class="icon-block">
                                <img src="/images/lcab.png" alt="Кабинет">
                            </div>
                            <div class="dropdown-content">
                                <!-- Блок авторизации -->
                                <div class="auth-buttons">
                                    <button class="login-btn">Войти</button>
                                    <button class="register-btn">Регистрация</button>
                                </div>
                                
                                <!-- Информация о пользователе -->
                                <div class="user-info" id="userInfo" style="display: none;">
                                    <p>Вы вошли как: <span id="currentUserEmail"></span></p>
                                    <button id="adminPanelBtn" style="display: none;">Админ-панель</button>
                                    <button id="logoutBtn">Выйти</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div id="loginModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Вход в аккаунт</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Пароль:</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit">Войти</button>
                </form>
            </div>
        </div>

    <!-- Основная навигация -->
    <!-- Основная навигация -->
<nav class="main-nav">
    <div class="nav-container">
        <!-- Блок каталога -->
        <div class="catalog-dropdown">
            <button class="catalog-btn">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span>КАТАЛОГ</span>
            </button>
            
            <!-- Контейнер меню (заполняется через JS) -->
            <div class="catalog-menu" data-catalog-container>
                <!-- Динамическое содержимое -->
            </div>
        </div>

        <!-- Основные пункты меню -->
        <div class="nav-items">
            <a href="#about">О КОМПАНИИ</a>
            <a href="#delivery">ДОСТАВКА</a>
            <a href="#payment">ОПЛАТА</a>
            <a href="#sales">АКЦИИ</a>
            <a href="#brands">БРЕНДЫ</a>
            <a href="#blog">БЛОГ</a>
            <a href="#contacts">КОНТАКТЫ</a>
        </div>
    </div>
</nav>

    <!-- Основное содержимое -->
    <main class="product-page">
        <!-- Хлебные крошки -->
        <nav class="breadcrumbs">
            <a href="/">Главная</a> / 
            <a href="/catalog.html">Корм для собак</a> / 
            <span class="current" id="current-breadcrumb"></span>
        </nav>

        <!-- Основной блок товара -->
        <section class="product-card">
            <div class="product-gallery">
                <img id="product-main-image" src="/images/placeholder.png" alt="Изображение товара" class="main-image">
            </div>
        
            <div class="product-details">
                <h1 id="product-title">Загрузка...</h1>
                
                <div class="product-meta">
                    <span class="sku" id="product-sku"></span>
                    <div class="rating" id="product-rating"></div>
                </div>
        
                <div class="price-block">
                    <div class="price" id="product-price"></div>
                    <select class="weight-select" id="weight-select">
                        <!-- Опции будут добавлены через JS -->
                    </select>
                </div>
        
                <!-- Блок действий с иконками -->
                <div class="product-actions">
                    <button class="btn-icon cart-btn" id="add-to-cart">
                        <img src="/images/cart.png" alt="Корзина">
                        В корзину
                    </button>
                    
                    <div class="action-icons">
                        <button class="icon-btn favorite-btn" 
                        id="add-to-favorites"
                        data-action="favorite">
                    <img src="/images/heart.png" alt="Избранное">
                </button>
                
                        <button class="icon-btn compare-btn" data-action="compare">
                            <img src="/images/compet.png" alt="Сравнение">
                            <span class="counter">0</span>
                        </button>
                    </div>
                </div>
        
                <div class="delivery-info">
                    <div class="stock" id="product-stock"></div>
                    <div class="delivery-options">
                        <img src="/images/delivery.png" alt="Доставка">
                        <span id="delivery-text"></span>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Характеристики -->
        <section class="specifications">
            <h2>Характеристики</h2>
            <div class="specs-grid" id="specs-grid">
                <!-- Динамически заполняется через JS -->
            </div>
        </section>
        
        <!-- Описание -->
        <section class="product-description">
            <h2>Описание товара</h2>
            <p id="product-description"></p>
        </section>
        
        <!-- Похожие товары -->
        <section class="related-products">
            <h2>Похожие товары</h2>
            <div class="related-grid" id="related-products">
                <!-- Динамически заполняется через JS -->
            </div>
        </section>

    <!-- Подвал -->
    <footer class="site-footer">
  <div class="footer-top">
    <div class="footer-logo">
      <img src="/images/logo.png" alt="Зуф-Зуф">
      <p>Зоомаркет ЗУФ-ЗУФ<br>Доставка товаров для животных по городу Сочи</p>
    </div>

    <div class="footer-links">
      <div class="footer-column">
        <h4>КАТАЛОГ</h4>
        <ul>
          <li><a href="#">Для кошек</a></li>
          <li><a href="#">Для собак</a></li>
          <li><a href="#">Для птиц/грызунов</a></li>
          <li><a href="#">Для рыб/черепах</a></li>
          <li><a href="#">Бренды</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h4>О КОМПАНИИ</h4>
        <ul>
          <li><a href="#">Гарантия</a></li>
          <li><a href="#">Доставка</a></li>
          <li><a href="#">Оплата</a></li>
          <li><a href="#">Условия возврата</a></li>
          <li><a href="#">Контакты</a></li>
          <li><a href="#">Блог</a></li>
          <li><a href="#">Вакансии</a></li>
          <li><a href="#">Отзывы</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-contacts">
      <p><strong>+7 (938) 441-39-13</strong><br><a href="#">Заказать звонок</a></p>
      <p><img src="/images/email.png" alt=""> info@zuf-zuf.ru</p>
      <p><img src="/images/location.png" alt=""> Сочи, ул. Яна Фабрициуса 58/5</p>
      <p><img src="/images/clock.jpg" alt=""> 7 дней в неделю<br>с 08:00 до 19:00</p>
      <p>ИП Немыкин Дмитрий Юрьевич<br>ИНН 236003969303</p>
    </div>
  </div>

  <div class="footer-bottom">
    <p>2025 © Зоомаркет Зуф-Зуф. 
      <a href="#">Карта сайта</a> 
      <a href="#">Политика конфиденциальности</a> 
      <a href="#">Пользовательское соглашение</a>
    </p>
    <div class="payment-icons">
      <img src="/images/paypal.png" alt="PayPal">
      <img src="/images/visa.png" alt="VISA">
      <img src="/images/mastercard.png" alt="MasterCard">
      <img src="/images/mir.png" alt="МИР">
      <img src="/images/yandex.png" alt="Yandex">
      <img src="/images/qiwi.png" alt="QIWI">
      <img src="/images/webmoney.png" alt="WebMoney">
    </div>
  </div>
</footer>


<!-- внизу product.html, вместо старого <script src="/data/products.js"> -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    if (!id) return showError('Товар не найден');

    try {
        const response = await fetch(`/api/products/${id}`);
        if (!response.ok) throw new Error('Ошибка загрузки');
        const product = await response.json();

        // Проверка основных элементов
        if (!document.getElementById('product-title')) {
            console.error('Элемент product-title не найден');
            return;
        }
        
                // Заполнение основной информации
                document.getElementById('product-title').textContent = product.title;
                document.getElementById('product-sku').textContent = `Артикул: ${product.sku}`;
                document.getElementById('product-description').textContent = product.description;
                const mainImage = document.getElementById('product-main-image');
                mainImage.src = product.imageUrl;
                mainImage.onerror = () => mainImage.src = '/images/placeholder.png';
        
                // Варианты веса
                const weightSelect = document.getElementById('weight-select');
                weightSelect.innerHTML = product.variants.map(v => `
                    <option value="${v.weight}" 
                            data-price="${v.price}"
                            data-variant-id="${v.variant_id}"
                            data-weight-unit="${v.weight_unit || 'г'}">
                        ${v.weight} ${v.weight_unit || 'г'} - ${v.price} ₽
                    </option>
                `).join('');
        
                // Обработчики изменения цены
                const updatePrice = () => {
                    const selected = weightSelect.selectedOptions[0];
                    document.getElementById('product-price').textContent = `${selected.dataset.price} ₽`;
                };
                weightSelect.addEventListener('change', updatePrice);
                updatePrice();
        
                // Характеристики товара
                const specsGrid = document.getElementById('specs-grid');
                specsGrid.innerHTML = `
                    <div class="spec-item">
                        <span class="spec-name">Бренд:</span>
                        <span class="spec-value">${product.brand}</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-name">Возраст:</span>
                        <span class="spec-value">${product.age_group}</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-name">Размер:</span>
                        <span class="spec-value">${product.size_group}</span>
                    </div>
                `;
        
                // Добавление в корзину
                const addToCartBtn = document.getElementById('add-to-cart');
                addToCartBtn.addEventListener('click', () => {
                    const selected = weightSelect.selectedOptions[0];
                    if (!selected) return alert('Выберите вариант товара');
        
                    const productData = {
                        id: product.id,
                        variantId: selected.dataset.variantId,
                        name: product.title,
                        price: parseFloat(selected.dataset.price),
                        image: product.imageUrl,
                        weight: `${selected.value} ${selected.dataset.weightUnit}`,
                        sku: product.sku
                    };
        
                    cart.addItem(productData, 1, productData.weight);
                    showNotification('Товар добавлен в корзину!');
                });
        
                // Избранное
                const favoriteBtn = document.getElementById('add-to-favorites');
                const updateFavoriteButton = () => {
                    const selected = weightSelect.selectedOptions[0];
                    if (!selected) return;
        
                    const isFavorite = favorites.items.some(item => 
                        item.id === product.id && 
                        item.variantId === selected.dataset.variantId
                    );
                    
                    favoriteBtn.classList.toggle('active', isFavorite);
                };
        
                favoriteBtn.addEventListener('click', () => {
                    const selected = weightSelect.selectedOptions[0];
                    if (!selected) return alert('Выберите вариант товара');
        
                    const productData = {
                        id: product.id,
                        variantId: selected.dataset.variantId,
                        name: product.title,
                        price: parseFloat(selected.dataset.price),
                        weight: `${selected.value} ${selected.dataset.weightUnit}`,
                        image: product.imageUrl
                    };
        
                    favorites.toggleFavorite(productData);
                    updateFavoriteButton();
                    showNotification(
                        favorites.items.some(item => item.id === product.id) 
                        ? 'Добавлено в избранное' 
                        : 'Удалено из избранного'
                    );
                });
        
                // Обновляем состояние кнопки при изменении варианта
                weightSelect.addEventListener('change', updateFavoriteButton);
                updateFavoriteButton();
        
            } catch (e) {
                showError('Ошибка загрузки товара');
                console.error(e);
            }
        });
       
        function showError(msg) {
            document.querySelector('.product-details').innerHTML = `
                <div class="error">
                    <h2>${msg}</h2>
                    <a href="/catalog.html">Вернуться в каталог</a>
                </div>
            `;
        }
        
        function showNotification(text) {
            const notification = document.createElement('div');
            notification.className = 'cart-notification';
            notification.textContent = text;
            
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.classList.add('hide');
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }
        </script>
        
        <style>
        .cart-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease-out;
            z-index: 1000;
        }
        
        .cart-notification.hide {
            animation: slideOut 0.3s ease-in;
        }
        
        .favorite-btn.active {
            background-color: #ffeded;
            border-color: #ff6b6b;
        }
        
        .favorite-btn.active img {
            filter: invert(26%) sepia(89%) saturate(2109%) hue-rotate(332deg) brightness(97%) contrast(91%);
        }
        
        @keyframes slideIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100px); opacity: 0; }
        }
        </style>
        

    <script src="/js/main.js"></script>
    <script src="/js/catalog.js"></script>
    <script src="/js/cart.js"></script> <!-- Подключите ваш класс корзины -->
    <!--<script src="/data/products.js"></script>-->
</body>
</html>